# bot-commands Specification

## Purpose
TBD - created by archiving change add-medication-reminder-system. Update Purpose after archive.
## Requirements
### Requirement: Создание расписания приема таблеток
Бот MUST предоставлять команду для создания расписания приема таблеток с указанием времени и частоты.

#### Scenario: Успешное создание расписания
- **WHEN** пользователь отправляет команду `/setreminder 09:00,14:00,21:00` в группе
- **THEN** бот создает расписание с тремя напоминаниями в день (09:00, 14:00, 21:00)
- **AND** бот отправляет подтверждающее сообщение с деталями расписания
- **AND** расписание сохраняется в базе данных с привязкой к пользователю и группе

#### Scenario: Некорректный формат времени
- **WHEN** пользователь отправляет команду `/setreminder 25:00`
- **THEN** бот отправляет сообщение об ошибке с объяснением правильного формата
- **AND** расписание не создается

#### Scenario: Расписание уже существует
- **WHEN** пользователь отправляет `/setreminder` и у него уже есть активное расписание
- **THEN** бот предлагает сначала удалить существующее расписание
- **AND** предоставляет команду для удаления

### Requirement: Просмотр активных расписаний
Бот MUST предоставлять команду для просмотра текущих активных расписаний пользователя.

#### Scenario: Просмотр существующего расписания
- **WHEN** пользователь отправляет команду `/myreminders`
- **AND** у пользователя есть активное расписание
- **THEN** бот отправляет список времен напоминаний
- **AND** показывает в какой группе настроено расписание

#### Scenario: Нет активных расписаний
- **WHEN** пользователь отправляет команду `/myreminders`
- **AND** у пользователя нет активных расписаний
- **THEN** бот отправляет сообщение "У вас нет активных расписаний"
- **AND** предлагает создать расписание через `/setreminder`

### Requirement: Редактирование расписания
Бот MUST предоставлять команду для изменения существующего расписания.

#### Scenario: Успешное редактирование
- **WHEN** пользователь отправляет команду `/editreminder 10:00,15:00`
- **AND** у пользователя есть активное расписание
- **THEN** бот обновляет расписание новыми временами
- **AND** отменяет старые cron-задачи
- **AND** создает новые cron-задачи
- **AND** отправляет подтверждение изменений

#### Scenario: Редактирование без существующего расписания
- **WHEN** пользователь отправляет команду `/editreminder 10:00`
- **AND** у пользователя нет активного расписания
- **THEN** бот отправляет сообщение об ошибке
- **AND** предлагает создать расписание через `/setreminder`

### Requirement: Удаление расписания
Бот MUST предоставлять команду для удаления расписания и прекращения напоминаний.

#### Scenario: Успешное удаление
- **WHEN** пользователь отправляет команду `/deletereminder`
- **AND** у пользователя есть активное расписание
- **THEN** бот удаляет расписание из базы данных
- **AND** отменяет все связанные cron-задачи
- **AND** отправляет подтверждение удаления

#### Scenario: Удаление без существующего расписания
- **WHEN** пользователь отправляет команду `/deletereminder`
- **AND** у пользователя нет активного расписания
- **THEN** бот отправляет сообщение "У вас нет активных расписаний для удаления"

### Requirement: Справочная информация
Бот MUST предоставлять команду для отображения справки по всем доступным командам.

#### Scenario: Запрос справки
- **WHEN** пользователь отправляет команду `/help`
- **THEN** бот отправляет список всех доступных команд
- **AND** для каждой команды показывает формат использования и описание
- **AND** приводит примеры использования команд

### Requirement: Команды управления шаблонами напоминаний
Бот MUST предоставлять администратору команды для добавления шаблонов напоминаний.

#### Scenario: Добавление шаблона напоминания
- **WHEN** администратор отправляет команду `/addreminder Не забудьте принять таблетки!`
- **THEN** бот создает новый активный шаблон типа "reminder" с указанным текстом
- **AND** бот отправляет подтверждение с ID созданного шаблона
- **AND** шаблон сохраняется в базе данных

#### Scenario: Попытка добавления пустого шаблона
- **WHEN** администратор отправляет команду `/addreminder` без текста
- **THEN** бот отправляет сообщение об ошибке с объяснением формата команды
- **AND** шаблон не создается

#### Scenario: Попытка использования команды не администратором
- **WHEN** обычный пользователь отправляет команду `/addreminder Текст`
- **THEN** бот отправляет сообщение "У вас нет прав для выполнения этой команды"
- **AND** команда не выполняется

### Requirement: Команды управления шаблонами наград
Бот MUST предоставлять администратору команды для добавления шаблонов наград.

#### Scenario: Добавление шаблона награды
- **WHEN** администратор отправляет команду `/addreward Отлично! Продолжайте в том же духе!`
- **THEN** бот создает новый активный шаблон типа "reward" с указанным текстом
- **AND** бот отправляет подтверждение с ID созданного шаблона
- **AND** шаблон сохраняется в базе данных

#### Scenario: Попытка добавления пустого шаблона награды
- **WHEN** администратор отправляет команду `/addreward` без текста
- **THEN** бот отправляет сообщение об ошибке с объяснением формата команды
- **AND** шаблон не создается

### Requirement: Команда удаления шаблонов
Бот MUST предоставлять администратору команду для удаления шаблонов сообщений.

#### Scenario: Успешное удаление шаблона
- **WHEN** администратор отправляет команду `/deletemessage abc-123-def`
- **AND** шаблон с указанным ID существует
- **THEN** бот удаляет шаблон из базы данных
- **AND** бот отправляет подтверждение удаления

#### Scenario: Удаление несуществующего шаблона
- **WHEN** администратор отправляет команду `/deletemessage invalid-id`
- **AND** шаблон с указанным ID не существует
- **THEN** бот отправляет сообщение "Шаблон не найден"
- **AND** операция не выполняется

#### Scenario: Попытка удаления без указания ID
- **WHEN** администратор отправляет команду `/deletemessage` без ID
- **THEN** бот отправляет сообщение об ошибке с объяснением формата команды

### Requirement: Команда просмотра шаблонов
Бот MUST предоставлять администратору команду для просмотра всех шаблонов сообщений.

#### Scenario: Просмотр всех шаблонов
- **WHEN** администратор отправляет команду `/listmessages`
- **THEN** бот отправляет список всех шаблонов с их ID, типом и содержимым
- **AND** отображает статус активности каждого шаблона
- **AND** группирует шаблоны по типу (reminder/reward)

#### Scenario: Просмотр шаблонов конкретного типа
- **WHEN** администратор отправляет команду `/listmessages reminder`
- **THEN** бот отправляет только шаблоны типа "reminder"
- **AND** отображает их ID, содержимое и статус

#### Scenario: Просмотр когда нет шаблонов
- **WHEN** администратор отправляет команду `/listmessages`
- **AND** в базе данных нет шаблонов
- **THEN** бот отправляет сообщение "Шаблоны не найдены"

### Requirement: Обновленная справка с админскими командами
Бот MUST отображать команды администратора в справке только для пользователей с правами администратора.

#### Scenario: Справка для администратора
- **WHEN** администратор отправляет команду `/help`
- **THEN** бот отправляет список всех команд включая административные
- **AND** административные команды помечены специальным маркером
- **AND** показывает формат и примеры использования админских команд

#### Scenario: Справка для обычного пользователя
- **WHEN** обычный пользователь отправляет команду `/help`
- **THEN** бот отправляет список только пользовательских команд
- **AND** административные команды не отображаются

