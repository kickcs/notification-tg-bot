## MODIFIED Requirements

### Requirement: Повторные напоминания при отсутствии подтверждения
Система MUST отправлять повторные напоминания если пользователь не подтвердил прием и удалять предыдущие сообщения-напоминания.

#### Scenario: Первое повторное напоминание
- **WHEN** прошло 15 минут после отправки напоминания
- **AND** пользователь не подтвердил прием
- **THEN** система удаляет предыдущее сообщение-напоминание
- **AND** отправляет новое повторное напоминание
- **AND** увеличивает счетчик попыток на 1
- **AND** сохраняет messageId нового сообщения
- **AND** сохраняет timestamp повторной отправки

#### Scenario: Максимум повторных попыток
- **WHEN** система отправила 3 повторных напоминания
- **AND** пользователь так и не подтвердил
- **THEN** система прекращает отправку повторных напоминаний
- **AND** помечает reminder как missed
- **AND** сохраняет информацию о пропуске

#### Scenario: Отмена повторных напоминаний после подтверждения
- **WHEN** пользователь подтверждает прием после первого напоминания
- **THEN** система отменяет все запланированные повторные напоминания
- **AND** не отправляет дополнительные сообщения

#### Scenario: Обработка ошибки удаления сообщения
- **WHEN** система пытается удалить предыдущее сообщение
- **AND** сообщение уже удалено пользователем или недоступно
- **THEN** система логирует предупреждение
- **AND** продолжает отправку нового напоминания
- **AND** не прерывает процесс из-за ошибки удаления

## ADDED Requirements

### Requirement: Сохранение идентификатора сообщения
Система MUST сохранять messageId отправленных напоминаний для возможности их последующего удаления.

#### Scenario: Сохранение messageId при первой отправке
- **WHEN** система отправляет первое напоминание
- **THEN** сохраняет messageId в базе данных
- **AND** связывает его с записью Reminder

#### Scenario: Обновление messageId при повторной отправке
- **WHEN** система отправляет повторное напоминание
- **THEN** обновляет messageId в базе данных
- **AND** заменяет старый messageId новым
