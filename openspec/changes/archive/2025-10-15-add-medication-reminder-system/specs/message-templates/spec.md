# Spec Delta: Message Templates

## ADDED Requirements

### Requirement: Хранение шаблонов сообщений в базе данных
Система MUST хранить шаблоны сообщений для напоминаний и наград в базе данных.

#### Scenario: Структура шаблона
- **WHEN** создается шаблон сообщения
- **THEN** запись содержит поля: id, type, content, isActive
- **AND** type может быть "reminder" или "reward"
- **AND** content содержит текст сообщения
- **AND** isActive определяет используется ли шаблон

#### Scenario: Множественные шаблоны одного типа
- **WHEN** в базе есть несколько шаблонов типа "reminder"
- **THEN** система может выбирать случайный из них
- **AND** обеспечивает разнообразие сообщений пользователям

### Requirement: Типы шаблонов
Система MUST поддерживать два типа шаблонов: напоминания и награды.

#### Scenario: Шаблоны напоминаний
- **WHEN** требуется отправить напоминание о приеме таблеток
- **THEN** система выбирает шаблон с type = "reminder"
- **AND** использует его content для текста сообщения

#### Scenario: Шаблоны наград
- **WHEN** пользователь подтверждает прием таблеток
- **THEN** система выбирает шаблон с type = "reward"
- **AND** отправляет мотивационное сообщение

### Requirement: Случайный выбор шаблона
Система MUST выбирать случайный активный шаблон при отправке сообщения.

#### Scenario: Выбор из активных шаблонов
- **WHEN** система отправляет напоминание
- **THEN** выбирает только шаблоны с isActive = true
- **AND** использует случайный выбор из доступных
- **AND** обеспечивает равномерное распределение

#### Scenario: Нет активных шаблонов
- **WHEN** в базе нет активных шаблонов нужного типа
- **THEN** система использует дефолтное сообщение
- **AND** логирует предупреждение
- **AND** продолжает работу без ошибки

### Requirement: Управление шаблонами
Система MUST позволять активировать и деактивировать шаблоны без удаления.

#### Scenario: Деактивация шаблона
- **WHEN** администратор деактивирует шаблон
- **THEN** поле isActive устанавливается в false
- **AND** шаблон больше не используется в случайном выборе
- **AND** запись остается в базе данных

#### Scenario: Активация шаблона
- **WHEN** администратор активирует шаблон
- **THEN** поле isActive устанавливается в true
- **AND** шаблон становится доступным для использования

### Requirement: Seed данные для шаблонов
Система MUST предоставлять базовые шаблоны при первой инициализации.

#### Scenario: Инициализация базовых шаблонов
- **WHEN** выполняется seed скрипт
- **THEN** создаются минимум 3 шаблона типа "reminder"
- **AND** создаются минимум 3 шаблона типа "reward"
- **AND** все шаблоны активны по умолчанию

#### Scenario: Содержание базовых шаблонов напоминаний
- **WHEN** создаются дефолтные шаблоны напоминаний
- **THEN** они содержат мотивирующий текст на русском языке
- **AND** напоминают о важности приема таблеток
- **AND** имеют дружелюбный тон

#### Scenario: Содержание базовых шаблонов наград
- **WHEN** создаются дефолтные шаблоны наград
- **THEN** они содержат позитивную обратную связь
- **AND** поощряют регулярный прием таблеток
- **AND** мотивируют продолжать в том же духе
