# –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ –º–∏–≥—Ä–∞—Ü–∏–π

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. –ü—Ä–æ–¥–∞–∫—à–Ω-—Å–∫—Ä–∏–ø—Ç—ã –º–∏–≥—Ä–∞—Ü–∏–π
- ‚úÖ `npm run prisma:migrate:prod` - –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –≤ production
- ‚úÖ `npm run prisma:status` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –º–∏–≥—Ä–∞—Ü–∏–π
- ‚úÖ `npm run prisma:rollback` - –û—Ç–∫–∞—Ç –º–∏–≥—Ä–∞—Ü–∏–π

### 2. –£–º–Ω—ã–π startup —Å–∫—Ä–∏–ø—Ç
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–π –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
- ‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–∫–∞—Ç –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö (–¥–æ 3 –ø–æ–ø—ã—Ç–æ–∫)
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å wait-for-it –¥–ª—è –æ–∂–∏–¥–∞–Ω–∏—è –ë–î

### 3. Health-check —Å–∏—Å—Ç–µ–º–∞
- ‚úÖ `scripts/migration-health.sh` - –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ö–µ–º—ã –∏ —Ç–∞–±–ª–∏—Ü
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

### 4. –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –±—ç–∫–∞–ø—ã
- ‚úÖ `scripts/backup-before-migration.sh` - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã
- ‚úÖ –°–∂–∞—Ç–∏–µ –±—ç–∫–∞–ø–æ–≤ (gzip)
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã–º–∏ –±—ç–∫–∞–ø–∞–º–∏
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏

### 5. Docker –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- ‚úÖ PostgreSQL client tools –≤ Docker
- ‚úÖ –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ volumes –¥–ª—è –±—ç–∫–∞–ø–æ–≤ –∏ —Å–∫—Ä–∏–ø—Ç–æ–≤
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏
- ‚úÖ Health checks –¥–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### 6. CI/CD –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- ‚úÖ Pre-deploy –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–∏–≥—Ä–∞—Ü–∏–π
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ö–µ–º—ã –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ production
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

### 7. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã
- ‚úÖ `scripts/migration-monitor.sh` - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ Webhook –∞–ª–µ—Ä—Ç—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤

### 8. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ –æ—Ç–∫–∞—Ç—ã
- ‚úÖ `scripts/restore-from-backup.sh` - –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∏–∑ –ª—é–±–æ–≥–æ –±—ç–∫–∞–ø–∞
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ emergency –±—ç–∫–∞–ø–æ–≤
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

## üîÑ –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

### –î–æ:
```bash
git pull
docker compose down
docker compose build
docker compose up -d
# ‚ùå –ú–∏–≥—Ä–∞—Ü–∏–∏ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–ª–∏—Å—å
```

### –ü–æ—Å–ª–µ:
```bash
git pull
./deploy.sh
# ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ —Å –±—ç–∫–∞–ø–∞–º–∏ –∏ –æ—Ç–∫–∞—Ç–æ–º
```

### –ù–æ–≤—ã–π deploy.sh –ø—Ä–æ—Ü–µ—Å—Å:
1. üóÇÔ∏è –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –º–∏–≥—Ä–∞—Ü–∏—è–º
2. üõë –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
3. üèóÔ∏è –°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–æ–≤
4. üöÄ –ó–∞–ø—É—Å–∫ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
5. ‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ë–î
6. üîÑ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π (—Å –æ—Ç–∫–∞—Ç–æ–º)
7. üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
8. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è

## üìä –ù–æ–≤—ã–µ package.json —Å–∫—Ä–∏–ø—Ç—ã

```json
{
  "prisma:migrate:prod": "prisma migrate deploy",
  "prisma:status": "prisma migrate status",
  "prisma:rollback": "prisma migrate reset --force",
  "migration:check": "./scripts/migration-health.sh",
  "migration:deploy": "./scripts/deploy-migration.sh",
  "migration:backup": "./scripts/backup-before-migration.sh",
  "migration:monitor": "./scripts/migration-monitor.sh",
  "migration:restore": "./scripts/restore-from-backup.sh"
}
```

## üöÄ –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ Docker
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
- –û—Ç–∫–∞—Ç –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø—Ä–æ—Å—Ç–æ–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –æ—Ç–∫–∞—Ç—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã –ø–µ—Ä–µ–¥ –∫–∞–∂–¥–æ–π –º–∏–≥—Ä–∞—Ü–∏–µ–π
- –û—Ç–∫–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- Emergency –±—ç–∫–∞–ø—ã –ø–µ—Ä–µ–¥ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π
- –ê–ª–µ—Ä—Ç—ã –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö
- –î–µ—Ç–∞–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã

### CI/CD –≤–∞–ª–∏–¥–∞—Ü–∏—è
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–π –ø–µ—Ä–µ–¥ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ–º
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ë–î
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ production

## üìã –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

- ‚úÖ TypeScript –∫–æ–º–ø–∏–ª—è—Ü–∏—è
- ‚úÖ Prisma –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
- ‚úÖ Docker —Å–±–æ—Ä–∫–∞
- ‚úÖ –°–∫—Ä–∏–ø—Ç—ã –º–∏–≥—Ä–∞—Ü–∏–π –∏—Å–ø–æ–ª–Ω—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ Health checks —Ä–∞–±–æ—Ç–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚úÖ CI/CD –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞

## üîß –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞:
```bash
npm run migration:check     # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
npm run prisma:migrate      # –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
npm run migration:monitor   # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
```

### Production:
```bash
./deploy.sh                 # –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏
npm run migration:check     # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ
npm run migration:restore   # –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
```bash
npm run migration:monitor check     # –†–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
npm run migration:monitor continuous # –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- `docs/MIGRATION_GUIDE.md` - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
- `scripts/*.sh` - –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥–µ —Å –ø–æ—è—Å–Ω–µ–Ω–∏—è–º–∏

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü—Ä–æ–±–ª–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –º–∏–≥—Ä–∞—Ü–∏–π –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞:

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏** —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞–¥–µ–∂–Ω–æ
2. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** –æ–±–µ—Å–ø–µ—á–µ–Ω–∞ –±—ç–∫–∞–ø–∞–º–∏ –∏ –æ—Ç–∫–∞—Ç–∞–º–∏
3. **CI/CD –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤–∏–¥–∏–º–æ—Å—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è
5. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** –ø–æ–º–æ–≥–∞–µ—Ç –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üöÄ